<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --bg:#f4f6f9;
      --card:#ffffff;
      --muted:#6c757d;
      --border:#e6e8ee;
      --accent:#0d6efd;
      --shadow: 0 10px 24px rgba(0,0,0,.06);
      --radius:14px;
    }

    body{background:var(--bg)}
    .sidebar{
      height:100vh; overflow:auto;
      background:var(--card);
      border-left:1px solid var(--border);
    }
    .frame{width:100%;height:100vh;border:0;background:#fff}

    .brand{
      background:linear-gradient(135deg,#0d6efd, #3b82f6);
      color:#fff;
      border-radius:var(--radius);
      padding:12px 12px;
      box-shadow: var(--shadow);
    }
    .brand .title{font-weight:900;font-size:1.05rem}
    .brand .sub{font-size:.85rem; opacity:.9}

    /* Section wrapper (visual separation) */
    .sec{
      border:1px solid var(--border);
      border-radius:var(--radius);
      background:#fff;
      box-shadow: 0 8px 18px rgba(0,0,0,.04);
      margin-top:12px;
      overflow:hidden;
    }
    .sec-h{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px;
      background:#f8fafc;
      border-bottom:1px solid var(--border);
      font-weight:800;
      font-size:.92rem;
    }
    .sec-h .hint{font-weight:600; font-size:.8rem; color:var(--muted)}
    .sec-b{padding:10px 10px 12px}

    /* Colored dots per section */
    .dot{width:10px;height:10px;border-radius:50%;display:inline-block;margin-left:8px}
    .dot.basic{background:#0d6efd}
    .dot.items{background:#f97316}
    .dot.ops{background:#16a34a}
    .dot.time{background:#8b5cf6}

    /* Links style */
    .menu{
      display:flex; flex-direction:column; gap:8px;
    }
    .menu a{
      border:1px solid var(--border);
      border-radius:12px;
      padding:10px 10px;
      background:#fff;
      display:flex;
      align-items:center;
      justify-content:space-between;
      text-decoration:none;
      color:#111827;
      transition:.15s ease;
    }
    .menu a:hover{
      transform: translateY(-1px);
      box-shadow: 0 10px 18px rgba(0,0,0,.06);
      border-color:#d7dbe6;
    }
    .menu a .left{
      display:flex; align-items:center; gap:8px;
      font-weight:700;
    }
    .menu a .tag{
      font-size:.72rem;
      padding:3px 8px;
      border-radius:999px;
      background:#eef2ff;
      color:#3730a3;
      border:1px solid #e0e7ff;
      font-weight:700;
    }

    /* Active link highlight */
    .menu a.active{
      border-color:#b6d1ff;
      background:#eff6ff;
      box-shadow: 0 10px 18px rgba(13,110,253,.10);
    }

    .footer-note{
      margin-top:12px;
      font-size:.8rem;
      color:var(--muted);
      text-align:center;
      padding:10px 0 2px;
    }
  </style>
</head>

<body>
<div class="container-fluid">
  <div class="row">

    <aside class="col-md-3 col-lg-2 sidebar p-3">
      <!-- Header / Brand -->
      <div class="brand mb-3 text-center">
        <div class="title">ğŸ§© Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª</div>
        <div class="sub">  Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ùˆ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
      </div>
      <!-- âœ… Section: Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª + Ø§Ù„ØªØ¹Ø±ÙŠÙØ§Øª -->
      <section class="sec">
        <div class="sec-h">
          <div><span class="dot basic"></span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„ØªØ¹Ø±ÙŠÙØ§Øª</div>
          <div class="hint">Ø´Ø±ÙƒØ© + Ø£ØµÙ†Ø§Ù + ÙˆØ­Ø¯Ø§Øª + Ù…ØµØ±ÙˆÙØ§Øª</div>
        </div>
        <div class="sec-b">
          <div class="menu">

            <a href="{% url 'portal:company' %}?embed=1" target="portal_frame" data-key="company">
              <div class="left">ğŸ¢ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©</div>
              <span class="tag">Company</span>
            </a>

            <a href="{% url 'portal:raw_materials' %}?embed=1" target="portal_frame" data-key="raw">
              <div class="left">ğŸ§± Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø®Ø§Ù…</div>
              <span class="tag">Raw</span>
            </a>

            <a href="{% url 'portal:products' %}?embed=1" target="portal_frame" data-key="products">
              <div class="left">ğŸ§¾ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
              <span class="tag">Products</span>
            </a>

            <a href="{% url 'portal:units' %}?embed=1" target="portal_frame" data-key="units">
              <div class="left">ğŸ“ ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø³</div>
              <span class="tag">Units</span>
            </a>

            <a href="{% url 'portal:conversions' %}?embed=1" target="portal_frame" data-key="conv">
              <div class="left">ğŸ” ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø§Øª</div>
              <span class="tag">Conv</span>
            </a>

            <a href="{% url 'portal:expenses_definitions' %}?embed=1" target="portal_frame" data-key="exp_def">
              <div class="left">ğŸ’¸ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
              <span class="tag">Expenses</span>
            </a>

            <a href="{% url 'portal:periods' %}?embed=1" target="portal_frame" data-key="periods">
              <div class="left">ğŸ—“ Ø§Ù„ÙØªØ±Ø§Øª</div>
              <span class="tag">Periods</span>
            </a>

            <a href="{% url 'portal:bom' %}?embed=1" target="portal_frame" data-key="bom">
              <div class="left">ğŸ§¾ BOM - Ø§Ù„ÙˆØµÙØ§Øª (Drag & Drop)</div>
              <span class="tag">BOM</span>
            </a>

          </div>
        </div>
      </section>

      <!-- âœ… Section: Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª -->
      <section class="sec">
        <div class="sec-h">
          <div><span class="dot ops"></span>Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª</div>
          <div class="hint">Ø­Ø±ÙƒØ§Øª Ø§Ù„ÙØªØ±Ø©</div>
        </div>
        <div class="sec-b">
          <div class="menu">

            <a href="{% url 'portal:expenses_entry' %}?embed=1" target="portal_frame" data-key="exp_entry">
              <div class="left">ğŸ§¾ Ø¥Ø¯Ø®Ø§Ù„ Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„ÙØªØ±Ø©</div>
              <span class="tag">Entry</span>
            </a>

            <a href="{% url 'portal:stockcount' %}?embed=1" target="portal_frame" data-key="stockcount">
              <div class="left">ğŸ“¦ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¬Ø±Ø¯</div>
              <span class="tag">Stock</span>
            </a>

            <a href="{% url 'portal:sales_entry' %}?embed=1" target="portal_frame" data-key="sales_entry">
              <div class="left">ğŸ’° Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
              <span class="tag">Sales</span>
            </a>

            <a href="{% url 'portal:purchases_entry' %}?embed=1" target="portal_frame" data-key="portal_purchases_entry">
              <div class="left">ğŸ§¾ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div>
              <span class="tag">Purchases</span>
            </a>

          </div>
        </div>
      </section>

      <!-- âœ… Section: Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
      <section class="sec">
        <div class="sec-h">
          <div><span class="dot time"></span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
          <div class="hint">Ø¹Ø±Ø¶ ÙˆØªØ­Ù„ÙŠÙ„</div>
        </div>
        <div class="sec-b">
          <div class="menu">
            <a href="/reports/" target="portal_frame" data-key="reports">
              <div class="left">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
              <span class="tag">Reports</span>
            </a>
          </div>
        </div>
      </section>



      <div class="footer-note">Â© Portal â€¢ ÙŠÙØªØ­ Ø¢Ø®Ø± Ø´Ø§Ø´Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</div>
    </aside>

    <main class="col-md-9 col-lg-10 p-0">
      <iframe id="portalFrame" name="portal_frame" class="frame"
              src="{% url 'portal:company' %}?embed=1"></iframe>
    </main>

  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const iframe = document.getElementById("portalFrame");
  const key = "portal_current_url";
  const saved = localStorage.getItem(key);

  // restore last url
  if (saved) iframe.src = saved;

  // set active link helper
  function setActiveByHref(href){
    document.querySelectorAll("a[target='portal_frame']").forEach(a => {
      a.classList.toggle("active", a.href === href);
    });
  }

  // initial active
  setActiveByHref(iframe.src);

  // on click save + highlight
  document.querySelectorAll("a[target='portal_frame']").forEach(a => {
    a.addEventListener("click", (e) => {
      localStorage.setItem(key, a.href);
      setActiveByHref(a.href);
    });
  });

  // if iframe navigates internally, keep highlight synced (best effort)
  iframe.addEventListener("load", () => {
    try{
      const current = iframe.contentWindow.location.href;
      localStorage.setItem(key, current);
      setActiveByHref(current);
    }catch(e){
      // cross-origin not expected here, ignore
    }
  });
});
</script>
</body>
</html>
