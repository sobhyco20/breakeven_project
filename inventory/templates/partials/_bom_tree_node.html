{% with p=node.product %}
{% load numfmt %}
<div class="tree-node level-{{ level }}">
    {% if p.code %}
        <strong>{{ p.code }}</strong> - {{ p.name }}
    {% elif p.sku %}
        <strong>{{ p.sku }}</strong> - {{ p.name }}
    {% else %}
        <strong>{{ p }}</strong>
    {% endif %}
    &nbsp;
    <span class="text-muted">(الكمية: {{ node.quantity|num:4 }})</span>

    {% if not node.components %}
        <span class="badge badge-type badge-raw ms-2">مادة خام</span>
    {% elif p.is_semi_finished %}
        <span class="badge badge-type badge-semi ms-2">منتج نصف مصنع</span>
    {% elif p.is_sellable %}
        <span class="badge badge-type badge-final ms-2">منتج نهائي</span>
    {% endif %}
</div>
{% endwith %}

{% if node.components %}
    <div class="tree-children">
        {% for child in node.components %}
            {% include "partials/_bom_tree_node.html" with node=child level=level|add:1 %}
        {% endfor %}
    </div>
{% endif %}
